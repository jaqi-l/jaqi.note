(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{488:function(e,r,a){"use strict";a.r(r);var t=a(56),v=Object(t.a)({},(function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"_9-1-docker概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-docker概述"}},[e._v("#")]),e._v(" 9.1 Docker概述")]),e._v(" "),a("h4",{attrs:{id:"docker为什么会出现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker为什么会出现"}},[e._v("#")]),e._v(" Docker为什么会出现？")]),e._v(" "),a("ul",[a("li",[e._v("传统的发布流程：")])]),e._v(" "),a("ol",[a("li",[e._v("发布项目时所有依赖都需要单独配置")]),e._v(" "),a("li",[e._v("开发环境、生产环境还要分别配置")]),e._v(" "),a("li",[e._v("不能跨平台")])]),e._v(" "),a("ul",[a("li",[a("code",[e._v("Docker")]),e._v("的发布流程：\n将业务代码和环境一起打包直接发布到服务器。")])]),e._v(" "),a("ol",[a("li",[e._v("常用的依赖和配置全部打包到"),a("code",[e._v("Docker")]),e._v("镜像仓库")]),e._v(" "),a("li",[e._v("发布时直接下载不需要单独配置")])]),e._v(" "),a("h4",{attrs:{id:"docker-hub"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-hub"}},[e._v("#")]),e._v(" Docker Hub")]),e._v(" "),a("p",[e._v("Docker的官方镜像仓库")]),e._v(" "),a("h4",{attrs:{id:"docker核心概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker核心概念"}},[e._v("#")]),e._v(" Docker核心概念")]),e._v(" "),a("ol",[a("li",[e._v('"镜像(image)"：依赖的程序和配置文件的集合')]),e._v(" "),a("li",[e._v('"仓库(repository)"：存放镜像的位置')]),e._v(" "),a("li",[e._v('"容器(container)"：使用虚拟化技术实现的运行镜像的环境')]),e._v(" "),a("li",[e._v('"隔离"：容器彼此隔离，互不影响')])]),e._v(" "),a("h4",{attrs:{id:"容器的生命周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器的生命周期"}},[e._v("#")]),e._v(" 容器的生命周期")]),e._v(" "),a("ol",[a("li",[a("code",[e._v("created")]),e._v("初建状态")]),e._v(" "),a("li",[a("code",[e._v("running")]),e._v("运行状态")]),e._v(" "),a("li",[a("code",[e._v("stopped")]),e._v("停止状态")]),e._v(" "),a("li",[a("code",[e._v("paused")]),e._v("暂停状态")])]),e._v(" "),a("h4",{attrs:{id:"底层原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#底层原理"}},[e._v("#")]),e._v(" 底层原理")]),e._v(" "),a("ul",[a("li",[e._v("Docker的工作原理")])]),e._v(" "),a("blockquote",[a("p",[e._v("Docker是一个Client-Server结构的系统，Docker的守护进程（一直在后台运行的进程）运行在主机上，通过Socket从客户端访问。\nDockerServer接收到Docker-Client的指令,就会执行这个命令。")])]),e._v(" "),a("h2",{attrs:{id:"_9-2-docker安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-docker安装"}},[e._v("#")]),e._v(" 9.2 Docker安装")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/get-docker/",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方文档"),a("OutboundLink")],1)]),e._v(" "),a("ol",[a("li",[e._v("查看centos内核版本（>=3.10）："),a("code",[e._v("uname -r")])]),e._v(" "),a("li",[e._v("安装之前需要卸载旧版：")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" sudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[e._v("安装docker环境："),a("code",[e._v("yum install -y yum-utils")])]),e._v(" "),a("li",[e._v("配置镜像仓库：")]),e._v(" "),a("li",[e._v("更新yum索引："),a("code",[e._v("yum makecache fast")])]),e._v(" "),a("li",[e._v("安装docker："),a("code",[e._v("yum install docker-ce docker-ce-cli containerd.io")])]),e._v(" "),a("li",[e._v("查看版本："),a("code",[e._v("docker version")])]),e._v(" "),a("li",[e._v("启动："),a("code",[e._v("systemctl start docker")])]),e._v(" "),a("li",[e._v("运行："),a("code",[e._v("docker run hello-world")])]),e._v(" "),a("li",[e._v("查看镜像："),a("code",[e._v("docker images")])]),e._v(" "),a("li",[e._v("卸载依赖："),a("code",[e._v("yum remove docker-ce docker-ce-cli containerd.io")])]),e._v(" "),a("li",[e._v("卸载资源："),a("code",[e._v("rm -rf /var/lib/docker")]),e._v("、"),a("code",[e._v("rm -rf /var/lib/containerd")])]),e._v(" "),a("li",[e._v("使用阿里云镜像加速器：")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('sudo mkdir -p /etc/docker\nsudo tee /etc/docker/daemon.json <<-\'EOF\'\n{\n  "registry-mirrors": ["https://g099lhap.mirror.aliyuncs.com"]\n}\nEOF\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n')])])]),a("h4",{attrs:{id:"docker-run的运行过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-run的运行过程"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker run")]),e._v("的运行过程")]),e._v(" "),a("p",[a("code",[e._v("docker run <imagesName>")])]),e._v(" "),a("blockquote",[a("ol",[a("li",[e._v("判断是否有这个镜像")]),e._v(" "),a("li",[e._v("没有则去DockerHub下载到本地")]),e._v(" "),a("li",[e._v("运行镜像")])])]),e._v(" "),a("h2",{attrs:{id:"_9-3-docker命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-docker命令"}},[e._v("#")]),e._v(" 9.3 Docker命令")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/reference/",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方命令文档"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("img",{attrs:{src:"/jaqi.note/docker1.jpg",alt:"docker"}})]),e._v(" "),a("p",[a("img",{attrs:{src:"/jaqi.note/docker2.jpg",alt:"docker"}})]),e._v(" "),a("p",[e._v("查看Docker版本："),a("code",[e._v("docker version")]),a("br"),e._v("\n查看Docker信息："),a("code",[e._v("docker info")]),a("br"),e._v("\nDocker帮助命令："),a("code",[e._v("docker <命令> --help")])]),e._v(" "),a("h2",{attrs:{id:"_9-4-镜像命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-镜像命令"}},[e._v("#")]),e._v(" 9.4 镜像命令")]),e._v(" "),a("h3",{attrs:{id:"docker-images查看镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-images查看镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker images")]),e._v("查看镜像")]),e._v(" "),a("p",[a("code",[e._v("docker images [OPTIONS] [REPOSITORY[:TAG]]")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-f")]),e._v("：过滤条件"),a("br"),e._v(" "),a("code",[e._v("-q")]),e._v("：只显示ID")])])]),e._v(" "),a("blockquote",[a("p",[e._v("返回参数")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("REPOSITORY")]),e._v("：镜像仓库"),a("br"),e._v(" "),a("code",[e._v("TAG")]),e._v("：镜像标签"),a("br"),e._v(" "),a("code",[e._v("TMAGE ID")]),e._v("：镜像ID"),a("br"),e._v(" "),a("code",[e._v("CREATED")]),e._v("：镜像创建事件"),a("br"),e._v(" "),a("code",[e._v("SIZE")]),e._v("：镜像创建大小")])])]),e._v(" "),a("ul",[a("li",[e._v("列出本地镜像中"),a("code",[e._v("REPOSITORY")]),e._v("为"),a("code",[e._v("ubuntu")]),e._v("的镜像列表")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" docker images  ubuntu\n")])])]),a("h3",{attrs:{id:"docker-search搜索镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-search搜索镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker search")]),e._v("搜索镜像")]),e._v(" "),a("p",[a("code",[e._v("docker search [OPTIONS] TERM")])]),e._v(" "),a("ul",[a("li",[e._v("从Docker Hub查找所有镜像名包含node，并且收藏数大于 10 的镜像")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" docker search -f stars=10 node\n")])])]),a("h3",{attrs:{id:"docker-pull下载镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-pull下载镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker pull")]),e._v("下载镜像")]),e._v(" "),a("p",[a("code",[e._v("docker pull [Registry]/[Repository]/[Image]:[Tag]")])]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("Registry")]),e._v("：注册服务器（用于管理镜像仓库的服务器）"),a("br"),e._v(" "),a("code",[e._v("Repository")]),e._v("：镜像仓库"),a("br"),e._v(" "),a("code",[e._v("tag")]),e._v("：镜像的标签，默认为latest。")])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("先从本地搜索，没有则从Docker Hub下载镜像。")])]),e._v(" "),a("p",[e._v("从Docker Hub下载node最新版镜像。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" docker pull node\n")])])]),a("h3",{attrs:{id:"docker-rmi删除镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-rmi删除镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker rmi")]),e._v("删除镜像")]),e._v(" "),a("p",[a("code",[e._v("docker rmi [OPTIONS] IMAGE [IMAGE...]")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-f")]),e._v("：强制删除")])])]),e._v(" "),a("ul",[a("li",[e._v("强制删除本地镜像 runoob/ubuntu:v4。")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" docker rmi -f runoob/ubuntu:v4 \n")])])]),a("ul",[a("li",[e._v("删除全部")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" docker rmi -f $(docker images -aq)\n")])])]),a("h3",{attrs:{id:"docker-image-prune清理镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-image-prune清理镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker image prune")]),e._v("清理镜像")]),e._v(" "),a("p",[e._v("清理残存、些临时、没有被使用的镜像文件")]),e._v(" "),a("h3",{attrs:{id:"docker-tag标记镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-tag标记镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker tag")]),e._v("标记镜像")]),e._v(" "),a("p",[a("code",[e._v("docker tag [SOURCE_IMAGE][:TAG] [TARGET_IMAGE][:TAG]")])]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("SOURCE_IMAGE")]),e._v("原始镜像"),a("br"),e._v(" "),a("code",[e._v("TARGET_IMAGE")]),e._v("：标记后的镜像")])]),e._v(" "),a("ul",[a("li",[e._v("将镜像ubuntu:15.10标记为 runoob/ubuntu:v3 镜像。")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker tag ubuntu:15.10 runoob/ubuntu:v3\n")])])]),a("h3",{attrs:{id:"docker-image-is查看镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-image-is查看镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker image is")]),e._v("查看镜像")]),e._v(" "),a("p",[a("code",[e._v("docker tag [Repository][:TAG]")])]),e._v(" "),a("ul",[a("li",[e._v("查看node镜像")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker image is node\n")])])]),a("h3",{attrs:{id:"docker-commit从容器创建一个新的镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-commit从容器创建一个新的镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker commit")]),e._v("从容器创建一个新的镜像")]),e._v(" "),a("p",[a("code",[e._v("docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-a")]),e._v("：提交的镜像作者"),a("br"),e._v(" "),a("code",[e._v("-c")]),e._v("：使用Dockerfile指令来创建镜\n"),a("code",[e._v("-m")]),e._v("：提交时的说明文字\n"),a("code",[e._v("-p")]),e._v("：在commit时，将容器暂停")])])]),e._v(" "),a("ul",[a("li",[e._v("将容器a404c6c174a2 保存为新的镜像,并添加提交人信息和说明信息。")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(' docker commit -a "jaqi.l" -m "jaqi.l\'The first image of jaqi.l" a404c6c174a2  jaqi.image:v1.0.0 \n')])])]),a("h3",{attrs:{id:"docker-build通过文件构建新镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-build通过文件构建新镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker build")]),e._v("通过文件构建新镜像")]),e._v(" "),a("p",[a("code",[e._v("docker build [OPTIONS] PATH | URL |")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-f")]),e._v("：dockerfile路径"),a("br"),e._v(" "),a("code",[e._v("-t")]),e._v("：镜像名")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker build -f dockerfile -t jaqi/centos:v1.0 .\n")])])]),a("h3",{attrs:{id:"docker-history查看镜像的构建历史"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-history查看镜像的构建历史"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker history")]),e._v("查看镜像的构建历史")]),e._v(" "),a("p",[a("code",[e._v("docker history [IMAGE ID]")])]),e._v(" "),a("h3",{attrs:{id:"docker-push发布镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-push发布镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker push")]),e._v("发布镜像")]),e._v(" "),a("p",[a("code",[e._v("docker push [OPTIONS] NAME[:TAG]")])]),e._v(" "),a("p",[e._v("发布之前需要登陆Docker Hub或阿里云镜像仓库")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker login ******\ndocker push jaqi/centos:v1.0\n")])])]),a("h3",{attrs:{id:"docker-save将指定镜像保存成tar归档文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-save将指定镜像保存成tar归档文件"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker save")]),e._v("将指定镜像保存成tar归档文件")]),e._v(" "),a("p",[a("code",[e._v("docker save [OPTIONS] [IMAGE...]")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-o")]),e._v("：输出到的文件\n将镜像 runoob/ubuntu:v3 生成 my_ubuntu_v3.tar 文档")])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3\n")])])]),a("h3",{attrs:{id:"docker-load导入使用docker-save命令导出的镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-load导入使用docker-save命令导出的镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker load")]),e._v("导入使用"),a("code",[e._v("docker save")]),e._v("命令导出的镜像")]),e._v(" "),a("p",[a("code",[e._v("docker load [OPTIONS]")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-i")]),e._v("：指定导入的文件"),a("br"),e._v(" "),a("code",[e._v("-q")]),e._v("：精简输出信息")])])]),e._v(" "),a("p",[e._v("导入my_ubuntu_v3.tar")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker load --i my_ubuntu_v3.tar\n")])])]),a("h2",{attrs:{id:"_9-5-容器命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-5-容器命令"}},[e._v("#")]),e._v(" 9.5 容器命令")]),e._v(" "),a("p",[e._v("有了镜像才能创建容器")]),e._v(" "),a("h3",{attrs:{id:"docker-run运行镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-run运行镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker run")]),e._v("运行镜像")]),e._v(" "),a("p",[a("code",[e._v("docker run [OPTIONS] [image]")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-name")]),e._v("：容器名字"),a("br"),e._v(" "),a("code",[e._v("-d")]),e._v("：后台运行方式"),a("br"),e._v(" "),a("code",[e._v("-rt")]),e._v("：用完即删"),a("br"),e._v(" "),a("code",[e._v("-it")]),e._v("：交互方式进行"),a("br"),e._v(" "),a("code",[e._v("-v")]),e._v("：挂载数据卷"),a("br"),e._v(" "),a("code",[e._v("-e")]),e._v("：环境配置"),a("br"),e._v(" "),a("code",[e._v("-p")]),e._v("：指定容器端口")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("ip:主机端口:容器端口")]),a("br"),e._v(" "),a("code",[e._v("主机端口:容器端口")]),a("br"),e._v(" "),a("code",[e._v("容器端口")])])])])]),e._v(" "),a("blockquote",[a("blockquote",[a("p",[a("code",[e._v("-P")]),e._v("：(大写P)随机容器端口")])])]),e._v(" "),a("ul",[a("li",[e._v("启动centos并进入容器")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" docker run -it centos /bin/bash\n")])])]),a("h3",{attrs:{id:"docker-rm删除容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-rm删除容器"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker rm")]),e._v("删除容器")]),e._v(" "),a("p",[a("code",[e._v("docker rm [image]")])]),e._v(" "),a("ul",[a("li",[e._v("批量删除多个")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" docker rm -f 09d7636201f2 104ea3abc382 c9054809ffad e3ae598e7447 f9ce4763ae59 9d86d1f77623 109b97c45b65 \n")])])]),a("h3",{attrs:{id:"docker-start启动容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-start启动容器"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker start")]),e._v("启动容器")]),e._v(" "),a("p",[a("code",[e._v("docker start [image]")])]),e._v(" "),a("h3",{attrs:{id:"docker-restart重启容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-restart重启容器"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker restart")]),e._v("重启容器")]),e._v(" "),a("p",[a("code",[e._v("docker restart [image]")])]),e._v(" "),a("h3",{attrs:{id:"docker-stop停止容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-stop停止容器"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker stop")]),e._v("停止容器")]),e._v(" "),a("p",[a("code",[e._v("docker stop [image]")])]),e._v(" "),a("h3",{attrs:{id:"docker-kill强制停止容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-kill强制停止容器"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker kill")]),e._v("强制停止容器")]),e._v(" "),a("p",[a("code",[e._v("docker kill [image]")])]),e._v(" "),a("h3",{attrs:{id:"docker-ps查看正在运行的容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-ps查看正在运行的容器"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker ps")]),e._v("查看正在运行的容器")]),e._v(" "),a("p",[a("code",[e._v("docker ps [OPTIONS]")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-a")]),e._v("：查看运行过的容器"),a("br"),e._v(" "),a("code",[e._v("-n")]),e._v("：查看最近运行的容器"),a("br"),e._v(" "),a("code",[e._v("-q")]),e._v("：只显示容器编号")])])]),e._v(" "),a("h3",{attrs:{id:"docker-attach进入容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-attach进入容器"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker attach")]),e._v("进入容器")]),e._v(" "),a("p",[a("code",[e._v("docker attach [image]")]),e._v("：进入容器正在运行的终端，不会开启新进程，退出后会自动停止容器服务")]),e._v(" "),a("h3",{attrs:{id:"docker-exec进入容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-exec进入容器"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker exec")]),e._v("进入容器")]),e._v(" "),a("p",[a("code",[e._v("docker exec -it [image] [COMMAND]")]),e._v("：进入容器后开启有一个新的终端")]),e._v(" "),a("h3",{attrs:{id:"docker-logs查看容器日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-logs查看容器日志"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker logs")]),e._v("查看容器日志")]),e._v(" "),a("p",[a("code",[e._v("docker logs [OPTIONS] [image]")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-f")]),e._v("：显示日志"),a("br"),e._v(" "),a("code",[e._v("-t")]),e._v("：显示日志条数")])])]),e._v(" "),a("h3",{attrs:{id:"docker-top查看容器中的进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-top查看容器中的进程"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker top")]),e._v("查看容器中的进程")]),e._v(" "),a("p",[a("code",[e._v("docker top [image]")])]),e._v(" "),a("h3",{attrs:{id:"docker-inspect查看容器内部信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-inspect查看容器内部信息"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker inspect")]),e._v("查看容器内部信息")]),e._v(" "),a("p",[a("code",[e._v("docker inspect [image]")])]),e._v(" "),a("h3",{attrs:{id:"docker-cp容器与主机之间的数据拷贝"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-cp容器与主机之间的数据拷贝"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker cp")]),e._v("容器与主机之间的数据拷贝")]),e._v(" "),a("p",[a("code",[e._v("docker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATH")])]),e._v(" "),a("blockquote",[a("p",[e._v("OPTIONS：可选项")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("-r")]),e._v("：递归")])])]),e._v(" "),a("ul",[a("li",[e._v("将主机/www/jaqi目录拷贝到容器96f7f14e99ab的/www目录下。")])]),e._v(" "),a("div",{staticClass:"language-CMD extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" docker cp /www/jaqi 96f7f14e99ab:/www/\n")])])]),a("ul",[a("li",[e._v("将容器96f7f14e99ab的/www目录拷贝到主机的/tmp目录中")])]),e._v(" "),a("div",{staticClass:"language-CMD extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" docker cp  96f7f14e99ab:/www /tmp/\n")])])]),a("h3",{attrs:{id:"exit退出并停止镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#exit退出并停止镜像"}},[e._v("#")]),e._v(" "),a("code",[e._v("exit")]),e._v("退出并停止镜像")]),e._v(" "),a("h3",{attrs:{id:"ctrl-p-q只退出镜像不停止"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ctrl-p-q只退出镜像不停止"}},[e._v("#")]),e._v(" "),a("code",[e._v("CTRL+P+Q")]),e._v("只退出镜像不停止")]),e._v(" "),a("h2",{attrs:{id:"_9-6-dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-6-dockerfile"}},[e._v("#")]),e._v(" 9.6 DockerFile")]),e._v(" "),a("p",[e._v("DockerFile就是用来构建docker镜像的构建文件（docker命令脚本）")]),e._v(" "),a("h4",{attrs:{id:"dockerfile语法规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile语法规则"}},[e._v("#")]),e._v(" DockerFile语法规则：")]),e._v(" "),a("ol",[a("li",[e._v("每个关键字（指令）都必须是大写字母")]),e._v(" "),a("li",[e._v("顺序从上到下")]),e._v(" "),a("li",[e._v("#表示注释")]),e._v(" "),a("li",[e._v("每个指令都会创建一个新的镜像层，并提交")])]),e._v(" "),a("h4",{attrs:{id:"dockerfile指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile指令"}},[e._v("#")]),e._v(" DockerFile指令：")]),e._v(" "),a("p",[a("code",[e._v("FROM")]),e._v("：基础镜像"),a("br"),e._v(" "),a("code",[e._v("MAINTAINEW")]),e._v("：镜像是谁写的，姓名+邮箱"),a("br"),e._v(" "),a("code",[e._v("RUN")]),e._v("：镜像构建的时候需要运行的命令"),a("br"),e._v(" "),a("code",[e._v("ADD")]),e._v("：添加内容"),a("br"),e._v(" "),a("code",[e._v("WORKDIR")]),e._v("：镜像的工作目录"),a("br"),e._v(" "),a("code",[e._v("VOLUME")]),e._v("：挂载的目录"),a("br"),e._v(" "),a("code",[e._v("EXPOSE")]),e._v("：暴露端口"),a("br"),e._v(" "),a("code",[e._v("CMD")]),e._v("：指定这个容器启动的时候要运行的命令，只有最后一个会生效"),a("br"),e._v(" "),a("code",[e._v("ENTRYPOINT")]),e._v("：指定这个容器启动的时候要运行的命令，可以追加命令"),a("br"),e._v(" "),a("code",[e._v("ONBUILD")]),e._v("：当构建一个被继承DockerFile，这个时候会运行ONBUILD的指令，触发指令"),a("br"),e._v(" "),a("code",[e._v("COPY")]),e._v("：类似ADD，将我们文件拷贝到镜像中"),a("br"),e._v(" "),a("code",[e._v("ENV")]),e._v("：构建时候设置环境变量")]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("`CMD`与`ENTRYPOINT`的区别")]),e._v(" "),a("p",[a("code",[e._v("CMD")]),e._v("：不能再docker run的时候再追加命令，只能替换。"),a("br"),e._v(" "),a("code",[e._v("ENTRYPOINT")]),e._v("：可以直接追加命令")])]),e._v(" "),a("ul",[a("li",[e._v("构建一个Jaqi.L/centos")])]),e._v(" "),a("div",{staticClass:"language-DockerFile extra-class"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("FROM")]),e._v(" centos")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("MAINTAINER")]),e._v(" Jaqi.L<Jaqi.l@qq.com>")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("ENV")]),e._v(" MYPATH /usr/local")]),e._v("\n\nWORKDIK $MYPATH\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("RUN")]),e._v(" yum -y install vim")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("EXPOSE")]),e._v(" 80")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("CMD")]),e._v(" echo "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$MYPATH")])]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("CMD")]),e._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"---end---"')])]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("CMD")]),e._v(" /bin/bash")]),e._v("\n")])])]),a("h2",{attrs:{id:"_9-7-docker镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-7-docker镜像"}},[e._v("#")]),e._v(" 9.7 Docker镜像")]),e._v(" "),a("h2",{attrs:{id:"_9-8-docker数据卷-volume"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-8-docker数据卷-volume"}},[e._v("#")]),e._v(" 9.8 Docker数据卷(volume)")]),e._v(" "),a("h4",{attrs:{id:"数据卷联合文件系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷联合文件系统"}},[e._v("#")]),e._v(" 数据卷联合文件系统")]),e._v(" "),a("p",[a("img",{attrs:{src:"/jaqi.note/docker-volume.jpg",alt:"docker"}})]),e._v(" "),a("h4",{attrs:{id:"数据共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据共享"}},[e._v("#")]),e._v(" 数据共享")]),e._v(" "),a("p",[e._v("容器之间共享数据的一种技术（将docker容器中的目录挂载到外部服务器上【卷名】），实现容器的持久化和同步操作，而且容器间也可以数据共享。")]),e._v(" "),a("p",[a("code",[e._v("docker run -v [服务器目录(卷名)]:[容器目录]:[r0/rw]")])]),e._v(" "),a("p",[e._v("容器限制权限：")]),e._v(" "),a("blockquote",[a("p",[a("code",[e._v("r0")]),e._v(":只读"),a("br"),e._v(" "),a("code",[e._v("rw")]),e._v("或不填:可读可写")])]),e._v(" "),a("ul",[a("li",[e._v("将容器的home目录挂载到服务器的/home/test目录")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker run -it -v /home/test:/home\n")])])]),a("h4",{attrs:{id:"具名和匿名挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#具名和匿名挂载"}},[e._v("#")]),e._v(" 具名和匿名挂载：")]),e._v(" "),a("p",[e._v("（不指定服务器的目录（卷名），自动挂载到"),a("code",[e._v("/var/lib/docker/volumes/xxx/_data")]),e._v("）")]),e._v(" "),a("h4",{attrs:{id:"docker-volume查看卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-volume查看卷"}},[e._v("#")]),e._v(" "),a("code",[e._v("docker volume")]),e._v("查看卷")]),e._v(" "),a("p",[a("code",[e._v("docker volume ls")]),e._v("查看全部卷"),a("br"),e._v(" "),a("code",[e._v("docker volume inspect [卷名]")]),e._v("查看卷详情")]),e._v(" "),a("h4",{attrs:{id:"数据卷容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷容器"}},[e._v("#")]),e._v(" 数据卷容器")]),e._v(" "),a("p",[a("code",[e._v("--volume-from")]),e._v("通过一个容器给其他容器共享数据。")]),e._v(" "),a("ul",[a("li",[e._v("docker01的数据同步到docker02")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker run -it --name docker02 --volume-from docker01 jaqi/centos:v1.0\n")])])]),a("h2",{attrs:{id:"_9-9-docker网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-9-docker网络"}},[e._v("#")]),e._v(" 9.9 Docker网络")])])}),[],!1,null,null,null);r.default=v.exports}}]);